{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Histórico do Candidato - Suplência</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <!-- <link rel="stylesheet" href="{% static 'assets/dist/css/style.css' %}"> -->
  <style>
    body {
      background-color: #f4f6f9;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
  
    .btn:hover {
      transform: scale(1.05);
      transition: transform 0.2s ease;
    }
  
    /* Timeline */
    .timeline {
      position: relative;
      padding: 20px 0;
      list-style: none;
    }
  
    .timeline:before {
      content: '';
      position: absolute;
      top: 0;
      bottom: 0;
      left: 30px;
      width: 4px;
      background: #dee2e6;
    }
  
    .timeline>li {
      position: relative;
      min-height: 50px;
      margin-bottom: 40px;
    }
  
    .timeline>li .timeline-panel {
      margin-left: 60px;
      background: #fff;
      border-radius: 6px;
      padding: 20px;
      position: relative;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    }
  
    .timeline>li .timeline-icon {
      position: absolute;
      top: 0;
      left: 15px;
      width: 30px;
      height: 30px;
      background: #0d6efd;
      color: #fff;
      border-radius: 50%;
      text-align: center;
      line-height: 30px;
      font-size: 14px;
    }
  
    /* Gráfico responsivo */
    .chart-container {
      position: relative;
      max-width: 100%;
      height: auto;
      margin: 0 auto;
      padding: 0 15px;
    }
  
    .chart-container canvas {
      position: relative;
      width: 100% !important;
      height: auto !important;
    }
  
    /* Banner do topo */
    .header-banner {
      background-image: url("{% static 'assets/dist/img/header_bg.jpg' %}");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      position: relative;
    }
  
    /* Responsividade geral */
    @media (max-width: 576px) {
      .timeline>li .timeline-panel {
        margin-left: 45px;
        padding: 15px;
      }
  
      .timeline:before {
        left: 20px;
      }
  
      .timeline>li .timeline-icon {
        left: 5px;
      }
  
      .card-body.text-center p {
        font-size: 0.95rem;
      }
  
      .btn {
        font-size: 0.9rem;
        padding: 8px 14px;
      }
  
      .chart-container {
        height: 220px;
      }
    }
  
  
    .footer-bg {
      background-image: url('{% static "assets/dist/img/footer-bg1.jpg" %}');
      background-repeat: no-repeat;
      background-position: center center;
      background-size: cover;
      position: relative;
      color: white;
    }
  
    .footer-bg .overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      /* Transparência de 50% */
      z-index: 1;
    }
  
    .footer-bg .container {
      position: relative;
      z-index: 2;
      /* Garante que o conteúdo fique na frente do overlay */
    }
  
  
    /* Transparência aplicada */
    .footer-bg::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      /* Preta com 50% de opacidade */
      z-index: 1;
    }
  
    .footer-content {
      position: relative;
      z-index: 2;
      /* Garante que o conteúdo fique acima da camada de transparência */
    }
  </style>

</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container">
    <a class="navbar-brand" href="#">
      <img src="{% static 'assets/dist/img/semed_branca.png' %}" alt="Logo SEMED" style="max-height: 40px;">
    </a>

    <!-- Botão do menu colapsável no mobile -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCandidato" aria-controls="navbarCandidato" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarCandidato">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="#"><i class="fas fa-user"></i> {{ request.user.email }}</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'login_candidato' %}"><i class="fas fa-sign-out-alt"></i> Sair</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<header class="header-banner text-white text-center py-5 shadow-sm rounded-bottom">
<div style="
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.6);
  z-index: 0;
"></div>

  <!-- Conteúdo do header com posicionamento acima da camada escura -->
  <div class="container position-relative" style="z-index: 1;">
    <h1 class="display-5 fw-bold">Área do Candidato</h1>
    
    <p class="lead fw-bold" style="color: #fff;">Acompanhe a evolução da sua inscrição e resultados</p>
    <hr class="border-light w-50 mx-auto">

    <div class="d-flex flex-column flex-md-row justify-content-center align-items-center gap-3 mt-3">
      <div>
        <i class="fas fa-user-circle fa-lg me-1"></i>
        <strong>{{ candidato.nome }}</strong>
      </div>
      <div class="d-none d-md-block">|</div>
      <div>
        <i class="fas fa-id-card fa-lg me-1"></i>
        CPF: {{ candidato.cpf }}
      </div>
    </div>

    <div class="d-flex justify-content-center flex-wrap gap-3 mt-4">

  {% if mostrar_botao_impressao %}
    <a href="{% url 'imprimir_inscricao' candidato.id %}" target="_blank" class="btn btn-warning fw-bold me-2">
      <i class="fas fa-file-pdf me-1"></i> Imprimir Inscrição
    </a>
  {% endif %}


  <a href="#" class="btn btn-lg btn-info text-white fw-bold shadow-sm px-4 py-2 d-flex align-items-center gap-2 rounded-pill"
    data-bs-toggle="modal" data-bs-target="#editarCadastroModal">
    <i class="fas fa-edit fa-lg"></i> Editar Cadastro
  </a>


  {% if mostrar_reinscricao and not candidato.reinscrito %}
  <a href="#" class="btn btn-danger"
     onclick="abrirModalReinscricao()" 
     data-bs-toggle="modal" 
     data-bs-target="#cadastroModal">
     <i class="fas fa-undo"></i> Reinscrever-se nas Pendentes
  </a>
  {% endif %}
</div>
  </div>

</header>

<form method="get" class="text-center mt-4">
  <div class="d-inline-block bg-light p-3 rounded shadow-sm border border-primary">
    <label for="ano" class="fw-bold text-primary me-2">
      <i class="fas fa-calendar-alt me-1"></i> Acompanhe sua trajetória por ano:
    </label>
    <select name="ano" id="ano" class="form-select d-inline-block w-auto fw-bold text-primary border-primary"
            onchange="this.form.submit()" style="display: inline-block; min-width: 120px;">
      {% for ano in anos_disponiveis %}
        <option value="{{ ano }}" {% if ano|stringformat:"s" == ano_selecionado|stringformat:"s" %}selected{% endif %}>
          {{ ano }}
        </option>
      {% endfor %}
    </select>
  </div>
</form>




<main class="container mt-5">

  <ul class="timeline">

    <li>
  <div class="timeline-icon"><i class="fas fa-user-check"></i></div>
  <div class="timeline-panel">
    <h5>Inscrição Confirmada</h5>
    <p>
  <strong>Data:</strong>
  {% if candidato.data_inscricao %}
    <span class="badge bg-light text-dark border">
      {{ candidato.data_inscricao|date:"d/m/Y \à\s H:i" }}
    </span>
  {% elif registro_anterior and registro_anterior.data_inscricao %}
    <span class="badge bg-secondary text-white border">
      {{ registro_anterior.data_inscricao|date:"d/m/Y \à\s H:i" }}
    </span>
  {% else %}
    <span class="text-muted">Não registrada</span>
  {% endif %}
</p>



    <p>Status:
      {% if candidato.status %}
        <span class="badge bg-success">{{ candidato.status|title }}</span>
      {% else %}
        <span class="badge bg-secondary">Indefinido</span>
      {% endif %}
    </p>
  </div>
</li>


    <li>
      <div class="timeline-icon bg-warning"><i class="fas fa-book-open"></i></div>
      <div class="timeline-panel">
        <h5>Prova Agendada</h5>
        <p>
          <strong>Local:</strong>
          <span class="badge bg-info text-dark">{{ candidato.local_prova }}</span>
        </p>
        <p>
          <strong>Escola:</strong>
          <span class="badge bg-secondary">{{ candidato.escola_2024 }}</span>
        </p>
      </div>
    </li>

    <li>
  <div class="timeline-icon bg-primary"><i class="fas fa-chart-pie"></i></div>

<div class="timeline-panel">
  <h5>Progresso da Inscrição</h5>
  <div class="chart-container mx-auto mb-3" style="max-width: 500px; height: 180px;">
    <canvas id="chartProgresso"></canvas>
  </div>

  {% with disciplinas_aprovadas|length as aprovadas_count %}
  {% with disciplinas_pendentes|length as pendentes_count %}
  {% with aprovadas_count|add:pendentes_count as total_disciplinas %}

  <div class="card shadow-sm border-0 mt-4">
    <div class="card-header bg-gradient-light text-center">
      <strong>Análise Geral de Disciplinas</strong>
    </div>
    <div class="card-body text-center">
      <p class="mb-2">
        <strong>Total de Disciplinas:</strong> {{ total_disciplinas }}
      </p>

      {% if total_disciplinas > 0 %}
        <p class="text-success mb-1">
          ✅ Aprovadas: {{ aprovadas_count }} ({{ percentualAprovadas }}%)
        </p>
        <p class="text-warning mb-0">
          ⚠️ Pendentes: {{ pendentes_count }} ({{ percentualPendentes }}%)
        </p>
      {% else %}
        <p class="text-muted mb-0">Nenhuma disciplina registrada até o momento.</p>
      {% endif %}
    </div>
  </div>

  {% endwith %}
  {% endwith %}
  {% endwith %}

  {% if disciplinas_aprovadas or disciplinas_pendentes %}
  <div class="row">
    <h6 class="text-success">✅ Disciplinas Aprovadas</h6>
    {% for disciplina, nota in disciplinas_aprovadas.items %}
      <div class="col-md-6 mb-2">
        <div class="alert alert-success d-flex justify-content-between align-items-center">
          <div><i class="fas fa-check-circle me-2"></i> {{ disciplina|capfirst }}</div>
          <span class="badge bg-light text-success fw-bold">Nota: {{ nota }}</span>
        </div>
      </div>
    {% endfor %}
  </div>

  <div class="row mt-3">
    <h6 class="text-warning">⚠️ Disciplinas Pendentes</h6>
    {% for disciplina, nota in disciplinas_pendentes.items %}
      <div class="col-md-6 mb-2">
        <div class="alert alert-warning d-flex justify-content-between align-items-center">
          <div><i class="fas fa-exclamation-triangle me-2"></i> {{ disciplina|capfirst }}</div>
          <span class="badge bg-light text-dark fw-bold">
            {% if nota is not None %}Nota: {{ nota }}{% else %}Não realizada{% endif %}
          </span>
        </div>
      </div>
    {% endfor %}
  </div>
  {% else %}
    <p class="mt-3">Status Final: <span class="badge bg-secondary">Em análise</span></p>
  {% endif %}
</div>



</li>

<li>
  <div class="timeline-icon bg-secondary"><i class="fas fa-list-alt"></i></div>
  <div class="timeline-panel">
    <h5>Disciplinas Selecionadas</h5>

    {% if candidato.prova_todas_disciplinas == 'Sim' %}
      <p>O candidato optou por realizar <strong>todas as disciplinas</strong>:</p>
      <div class="row mt-2">
        {% for disciplina in todas_disciplinas %}
          <div class="col-md-3 col-6 mb-2">
            <span class="badge bg-primary w-100 py-2 d-block text-center">
              <i class="fas fa-check-circle me-1"></i>{{ disciplina.nome }}
            </span>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p>O candidato optou por realizar apenas disciplinas específicas:</p>
      {% if disciplinas_lista %}
        <div class="row mt-2">
          {% for disciplina in disciplinas_lista %}
            <div class="col-md-3 col-6 mb-2">
              <span class="badge bg-primary w-100 py-2 d-block text-center">
                <i class="fas fa-check-circle me-1"></i>{{ disciplina }}
              </span>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p class="text-muted">Nenhuma disciplina informada.</p>
      {% endif %}
    {% endif %}
  </div>
</li>

    <li>
      <div class="timeline-icon bg-info"><i class="fas fa-file-alt"></i></div>
      <div class="timeline-panel">
        <h5>Resultado</h5>
        <p>Nota: {{ candidato.media_geral|default:"Ainda não disponível" }}</p>
        {% if disciplinas_aprovadas or disciplinas_pendentes %}
          <p>Status Final:
            {% if status_final == "Aprovado" %}
              <span class="badge bg-success">Aprovado</span>
            {% elif status_final == "Parcial" %}
              <span class="badge bg-warning text-dark">Aprovado Parcialmente</span>
            {% else %}
              <span class="badge bg-danger">Reprovado</span>
            {% endif %}
          </p>

          <hr>
          <h6 class="text-success">✅ Disciplinas Aprovadas</h6>
          <div class="row">
            {% for disciplina, nota in disciplinas_aprovadas.items %}
              <div class="col-md-6 mb-2">
                <div class="alert alert-success d-flex justify-content-between align-items-center">
                  <div><i class="fas fa-check-circle me-2"></i> {{ disciplina|capfirst }}</div>
                  <span class="badge bg-light text-success fw-bold">Nota: {{ nota }}</span>
                </div>
              </div>
            {% endfor %}
          </div>
          <h6 class="text-warning mt-4">⚠️ Disciplinas Pendentes</h6>
          <div class="row">
            {% for disciplina, nota in disciplinas_pendentes.items %}
              <div class="col-md-6 mb-2">
                <div class="alert alert-warning d-flex justify-content-between align-items-center">
                  <div><i class="fas fa-exclamation-triangle me-2"></i> {{ disciplina|capfirst }}</div>
                  <span class="badge bg-light text-dark fw-bold">
                    {% if nota is not None %}Nota: {{ nota }}{% else %}Não realizada{% endif %}
                  </span>
                </div>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <p>Status Final: <span class="badge bg-secondary">Em análise</span></p>
        {% endif %}
      </div>
    </li>

    {% if candidato.certificado_emitido %}
    <li>
      <div class="timeline-icon bg-success"><i class="fas fa-certificate"></i></div>
      <div class="timeline-panel">
        <h5>Certificado Emitido</h5>
        <p>Data: {{ candidato.certificado_data_emissao }}</p>
      </div>
    </li>
    {% endif %}

    <li>
  <div class="timeline-icon bg-dark"><i class="fas fa-table"></i></div>
  <div class="timeline-panel">
    <h5>Resumo Geral das Notas</h5>
    <div class="table-responsive">
      <table class="table table-bordered table-sm table-striped text-center">
        <thead class="table-dark">
          <tr>
            {% for disciplina in disciplinas.keys %}
              <th>{{ disciplina }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          <tr>
            {% for nota in disciplinas.values %}
              <td>
                {% if nota is not None %}
                  {{ nota|stringformat:".1f" }}
                {% else %}
                  <span class="text-muted">N/A</span>
                {% endif %}
              </td>
            {% endfor %}
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</li>

  </ul>

</main>



              <!-- Modal for user registration -->
            <div class="modal fade" id="cadastroModal" tabindex="-1" aria-labelledby="cadastroModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-xl"> <!-- Modal is larger to accommodate more fields -->
                    <div class="modal-content">

                        <div class="modal-header d-flex justify-content-between align-items-center flex-wrap">
                <h5 class="modal-title mb-0" id="cadastroModalLabel" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                    Informações do Participante
                </h5>
                <p class="modal-location text-end mb-0 ms-auto small text-muted" id="modalDateLocation" style="white-space: nowrap;">
                    Canaã dos Carajás, PA: <span id="currentDate"></span>
                </p>
            </div>


            <div class="modal-body">

                <!-- Timer with modern design -->
                <div class="timer-container text-center">
                    <div class="timer-circle">
                        <span id="timer">20:00</span>
                    </div>
                    <p style="font-size: 1.0rem; font-weight: bold; color: #d9534f; text-align: center; margin-top: 10px;">
                        ⏳ Tempo restante para preencher o cadastro.
                    </p>
                    
                    <p style="font-size: 1.2rem; font-weight: bold; color: #f47835; text-align: center; margin-top: 20px;">
                        📚 Exame de Suplência 2025.
                    </p>
                    
                </div>
                <hr>

                <form id="reinscricaoForm" method="POST" action="{% url 'reinscrever_usuario' %}">
                {% csrf_token %}

                    <div class="row">
                        <!-- Nome Completo -->
                        <div class="col-md-4 mb-3">
                            <label for="nome_completo" class="form-label">Nome Completo</label>
                            <input type="text" class="form-control" id="nome_completo" name="nome_completo" required>
                        </div>

                        <!-- Email -->
                        <div class="col-md-4 mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                        </div>

                        <!-- CPF -->
                        <!-- CPF do Candidato Formulário -->
                        <div class="col-md-4 mb-3">
                            <label for="cpf_form" class="form-label">Número do CPF do Candidato</label>
                            <input type="text" id="cpf_form" name="cpf_form" class="form-control" placeholder="Digite seu CPF" required>
                        </div>

                        
                    </div>
                    <!-- ****************************************************************************************************************************** -->


                    <div class="row">
                        

                        <!-- Data de Nascimento -->
                        <div class="col-md-4 mb-3">
                            <label for="dataNascimento" class="form-label">Data de Nascimento</label>
                            <input type="date" class="form-control" id="data_nascimento" name="data_nascimento" required onchange="verificarIdade()">
                        </div>

                          <!-- Radio buttons para maior de idade, inicialmente desabilitados -->
                        <div class="col-md-4 mb-3">
                            <label for="maior_de_18" class="form-label">O Candidato é maior de 18 anos?</label><br>
                            <div class="form-check form-check-inline">
                                <input type="radio" id="maior_de_18_sim" name="maior_de_18" value="Sim" class="form-check-input" onchange="verificarMaiorIdade()" disabled checked>
                                <label for="maior_de_18_sim" class="form-check-label">Sim</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input type="radio" id="maior_de_18_nao" name="maior_de_18" value="Não" class="form-check-input" onchange="verificarMaiorIdade()" disabled>
                                <label for="maior_de_18_nao" class="form-check-label">Não</label>
                            </div>
                        </div>

                        <!-- Nome do Responsável legal -->
                        <div class="col-md-4 mb-3">
                            <label for="nomeResponsavel" class="form-label">Nome do Responsável Legal</label>
                            <input type="text" class="form-control" id="nome_responsavel" name="nome_responsavel" disabled>
                        </div>
                        
                        
                    </div>

                    <!-- ****************************************************************************************************************************** -->

                    <div class="row">
                       

                        <div class="col-md-4 mb-3">
                            <label for="cpf_responsavel" class="form-label">CPF do Responsável</label>
                        <input type="text" class="form-control" id="cpf_responsavel" name="cpf_responsavel" disabled>
                        </div>
                        
                        <!-- Nome do Responsável legal -->
                        <div class="col-md-4 mb-3">
                            <label for="rg_responsavel" class="form-label">RG do Responsável</label>
                        <input type="text" class="form-control" id="rg_responsavel" name="rg_responsavel" disabled>
                        </div>

                        <!-- Tipo de Responsável Legal -->
                        <div class="col-md-4 mb-3">
                            <label for="tipoResponsavel" class="form-label">Tipo de Responsável Legal</label>
                            <select class="form-control" id="tipo_responsavel" name="tipo_responsavel" disabled>
                                <option value="">Selecione</option>
                                <option value="pai">Pai</option>
                                <option value="mae">Mãe</option>
                                <option value="outro">Outro</option>
                            </select>
                        </div>

                    </div>

                    <!-- ****************************************************************************************************************************** -->

                    <div class="row">
                        

                        <!-- Telefone -->
                        <div class="col-md-4 mb-3">
                            <label for="telefone" class="form-label">Nº de Telefone do Candidato</label>
                            <input type="tel" class="form-control" id="telefone" name="telefone" required>
                        </div>

                        <!-- Telefone 2 -->
                        <div class="col-md-4 mb-3">
                            <label for="telefone_2" class="form-label">Telefone de Contato 2</label>
                            <input type="tel" class="form-control" id="telefone_2" name="telefone_2">
                        </div>

                        <!-- Cidade -->
                        <div class="col-md-4 mb-3">
                            <label for="cidade" class="form-label">Cidade</label>
                            <input type="text" class="form-control" id="cidade" name="cidade" required>
                        </div>

                    </div>
                    <!-- ****************************************************************************************************************************** -->

                    <div class="row">
                        

                         <!-- Endereço -->
                         <div class="col-md-4 mb-3">
                            <label for="endereco" class="form-label">Endereço</label>
                            <input type="text" class="form-control" id="endereco" name="endereco" required>
                        </div>

                        <!-- Bairro -->
                        <div class="col-md-4 mb-3">
                            <label for="bairro" class="form-label">Bairro</label>
                            <select class="form-control" id="bairro" name="bairro" required>
                                <option value="">Selecione o Bairro</option>
                                <!-- Add options dynamically -->
                            </select>
                        </div>


                            <!-- Fez exame supletivo -->
    <div class="col-md-4 mb-3">
        <label for="fez_exame_supletivo" class="form-label">Já fez a prova do exame supletivo?</label><br>
        <div class="form-check form-check-inline">
            <input type="radio" id="fez_exame_sim" name="fez_exame_supletivo" value="Sim" class="form-check-input" required>
            <label for="fez_exame_sim" class="form-check-label">Sim</label>
        </div>
        <div class="form-check form-check-inline">
            <input type="radio" id="fez_exame_nao" name="fez_exame_supletivo" value="Não" class="form-check-input" required checked>
            <label for="fez_exame_nao" class="form-check-label">Não</label>
        </div>
    </div>

    <!-- Ano da última prova -->
    <div class="col-md-4 mb-3" id="ano_ultima_prova_div" style="display: none;">
        <label for="ano_ultima_prova" class="form-label">Ano da última prova</label>
        <input type="number" class="form-control" id="ano_ultima_prova" name="ano_ultima_prova" min="2000" max="2025">
    </div>
</div>



                   

                    <!-- ****************************************************************************************************************************** -->

                    <div class="row align-items-start">

                      <!-- Prova de todas disciplinas -->
<!-- PERGUNTA -->
<div class="col-md-4 mb-3">
    <label class="form-label">Deseja realizar a prova de todas as disciplinas?</label><br>
    <div class="form-check form-check-inline">
        <input type="radio" id="prova_todas_disciplinas_sim" name="prova_todas_disciplinas"
               value="Sim" class="form-check-input" onchange="toggleDisciplinas()" disabled>
        <label for="prova_todas_disciplinas_sim" class="form-check-label">Sim</label>
    </div>
    <div class="form-check form-check-inline">
        <input type="radio" id="prova_todas_disciplinas_nao" name="prova_todas_disciplinas"
               value="Não" class="form-check-input" onchange="toggleDisciplinas()" required checked>
        <label for="prova_todas_disciplinas_nao" class="form-check-label">Não</label>
    </div>
</div>

<!-- CONTAINER DAS DISCIPLINAS -->
<div class="col-md-8 mb-3" id="container-disciplinas">
    <label class="form-label">Qual(is) disciplina(s) deseja realizar a prova?</label>
    <div class="row">
        {% for disciplina in disciplinas_pendentes_nomes %}
        <div class="col-md-6 mb-2">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" name="disciplinas[]" value="{{ disciplina }}"
                       id="disc_{{ forloop.counter }}" checked>
                <label class="form-check-label" for="disc_{{ forloop.counter }}">{{ disciplina }}</label>
            </div>
        </div>
        {% empty %}
        <p class="text-muted">Nenhuma disciplina pendente.</p>
        {% endfor %}
    </div>
</div>




<!-- <script>
function toggleDisciplinas() {
    const sim = document.getElementById('prova_todas_disciplinas_sim');
    const container = document.getElementById('container-disciplinas');
    if (sim.checked) {
        container.style.display = 'none';

        document.querySelectorAll('input[name="disciplinas[]"]').forEach(cb => cb.checked = false);
    } else {
        container.style.display = 'block';
    }
}


document.addEventListener('DOMContentLoaded', toggleDisciplinas);
</script> -->


                      <!-- Necessidade especial -->
                      <div class="col-md-4 mb-3">

                          <label for="necessidade_especial" class="form-label">Possui necessidade especial?</label><br>

                          <div class="form-check form-check-inline">
                              <input type="radio" id="necessidade_especial_sim" name="possui_necessidade_especial"
                                  value="Sim" class="form-check-input" required onchange="toggleSpecialNeeds(true)">
                              <label for="necessidade_especial_sim" class="form-check-label">Sim</label>
                          </div>

                          <div class="form-check form-check-inline">
                              <input type="radio" id="necessidade_especial_nao" name="possui_necessidade_especial"
                                  value="Não" class="form-check-input" checked onchange="toggleSpecialNeeds(false)">
                              <label for="necessidade_especial_nao" class="form-check-label">Não</label>
                          </div>

                      </div>

                  </div>

                    <!-- ****************************************************************************************************************************** -->

                    <div class="row">

                        <div class="col-md-4 mb-3">
                            <label for="necessidade_especial_detalhe" class="form-label">Caso possua, favor
                                assinalar</label>
                            <select class="form-select" id="necessidade_especial_detalhe"
                                name="necessidade_especial_detalhe" disabled>
                                <option value="">Selecione...</option>
                                <option value="Baixa Visão">Baixa Visão</option>
                                <option value="Cegueira">Cegueira</option>
                                <option value="Auditiva">Deficiência Auditiva</option>
                                <option value="Deficiência Física">Deficiência Física</option>
                                <option value="Deficiência Intelectual">Deficiência Intelectual</option>
                                <option value="Surdez">Surdez</option>
                                <option value="Surdocegueira">Surdocegueira</option>
                                <option value="Transtorno do espectro autista">Transtorno do espectro autista</option>
                                <option value="Altas habilidades/superdotação">Altas habilidades/superdotação</option>
                                <option value="Outras">Outras</option>
                            </select>
                        </div>

                        <!-- Senha -->
                        <div class="col-md-4 mb-3">
                            <label for="senha" class="form-label">Senha</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="senha" name="senha" required>
                                <div class="input-group-append">
                                    <span class="input-group-text" style="cursor: pointer;" onclick="togglePassword('senha', 'eyeSenha')">
                                        <i id="eyeSenha" class="fas fa-eye" style="font-size: 1.5em;"></i>
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Confirmar Senha -->
                        <div class="col-md-4 mb-3">
                            <label for="confirmar_senha" class="form-label">Confirmar Senha</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="confirmar_senha" name="confirmar_senha" required>
                                <div class="input-group-append">
                                    <span class="input-group-text" style="cursor: pointer;" onclick="togglePassword('confirmar_senha', 'eyeConfirmarSenha')">
                                        <i id="eyeConfirmarSenha" class="fas fa-eye" style="font-size: 1.5em;"></i>
                                    </span>
                                </div>
                            </div>
                        </div>
                   <hr>
                        <div class="row">
                            <h5 class="text-primary">Informações sobre a Prova</h5>
                        
                            <!-- Local de Realização da Prova -->
                            <div class="col-md-4 mb-3">
                                <label for="local_prova" class="form-label">Em qual local deseja realizar as provas?*</label>
                                <select class="form-control" id="local_prova" name="local_prova" required>
                                    <option value="CMEJA Jose de Deus Andrade" selected>CMEJA Jose de Deus Andrade</option>
                                    <option value="EMEB Tancredo Neves">EMEB Tancredo Neves</option>
                                    <option value="EMEB Benedita Torres">EMEB Benedita Torres</option>
                                    <option value="EMEB Adelaide Molinari">EMEB Adelaide Molinari</option>
                                    <option value="EMEB Teotônio Vilela">EMEB Teotônio Vilela</option>
                                    <option value="EMEB Luiz Carlos Prestes">EMEB Luiz Carlos Prestes</option>
                                    <!-- Add other options here -->
                                </select>
                            </div>
                        
                            <div class="col-md-4 mb-3">
                                <label for="data_prova" class="form-label">Data de realização da Prova*</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="data_prova_checkbox" name="data_prova_checkbox" checked disabled>
                                    <label class="form-check-label" for="data_prova_checkbox">01/10/2025</label>
                                </div>
                            </div>
                            
                            <!-- Nome da Escola (Se Estudando) -->
                            <div class="col-md-4 mb-3">
                                <label for="escola_2024" class="form-label">Caso esteja matriculado em 2025, qual escola*</label>
                                <select class="form-control" id="escola_2024" name="escola_2024" required>
                                    <option value="NÃO ESTOU ESTUDANDO EM 2025" selected>NÃO ESTOU ESTUDANDO EM 2025</option>
                                    <option value="CMEJA JOSÉ DE DEUS ANDRADE">CMEJA JOSÉ DE DEUS ANDRADE</option>
                                    <option value="EMEIF ADELAIDE MOLINARI">EMEIF ADELAIDE MOLINARI</option>
                                    <option value="EMEIF CARLOS HENRIQUE">EMEIF CARLOS HENRIQUE</option>
                                    <option value="EMEIF JUSCELINO KUBITSCHEK">EMEIF JUSCELINO KUBITSCHEK</option>
                                    <option value="EMEIF MAGALHÃES BARATA">EMEIF MAGALHÃES BARATA</option>
                                    <option value="EMEIF RAIMUNDO DE OLIVEIRA">EMEIF RAIMUNDO DE OLIVEIRA</option>
                                    <option value="EMEIF TEOTÔNIO VILELA">EMEIF TEOTÔNIO VILELA</option>
                                    <option value="EMEF BENEDITA TORRES">EMEF BENEDITA TORRES</option>
                                    <option value="EMEF SEBASTIÃO AGRIPINO DA SILVA">EMEF SEBASTIÃO AGRIPINO DA SILVA</option>
                                    <option value="EMEF ALEXSANDRO NUNES DE SOUZA GOMES">EMEF ALEXSANDRO NUNES DE SOUZA GOMES</option>
                                    <option value="EMEF CARMELO MENDES DA SILVA">EMEF CARMELO MENDES DA SILVA</option>
                                    <option value="EMEB LUÍS CARLOS PRESTES">EMEB LUÍS CARLOS PRESTES</option>
                                    <option value="EMEF JOÃO NELSON DOS PRAZERES HENRIQUES">EMEF JOÃO NELSON DOS PRAZERES HENRIQUES</option>
                                    <option value="EMEF MARIA DE LOURDES ROCHA RODRIGUES">EMEF MARIA DE LOURDES ROCHA RODRIGUES</option>
                                    <option value="EMEB RONILTON ARIDAL DA SILVA GRILO">EMEB RONILTON ARIDAL DA SILVA GRILO</option>
                                    <option value="EMEB GERCINO CORREA">EMEB GERCINO CORREA</option>
                                    <option value="EMEIF TANCREDO DE ALMEIDA NEVES">EMEIF TANCREDO DE ALMEIDA NEVES</option>
                                    <option value="EMEIF FRANCISCA ROMANA">EMEIF FRANCISCA ROMANA</option>
                                    <!-- Add more options here -->
                                </select>
                            </div>
                        </div>
                    </div>
                    <!-- ****************************************************************************************************************************** -->

                    <div class="row">
                      <!-- Deseja participar do Aulão? -->
                      <!-- Pergunta principal -->
                      <div class="mb-3">
                        <label class="form-label">Deseja participar dos aulões preparatórios para o exame de suplência 2025?</label><br>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="deseja_participar_aulao" id="aulao_sim" value="Sim" onchange="toggleAulaoCampos()" required>
                          <label class="form-check-label" for="aulao_sim">Sim</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="deseja_participar_aulao" id="aulao_nao" value="Não" onchange="toggleAulaoCampos()" checked required>
                          <label class="form-check-label" for="aulao_nao">Não</label>
                        </div>
                      </div>

                      <!-- Turnos (inicialmente oculto) -->
                      <div id="aulao_campos" style="display: none;">
                        <label class="form-label">Em caso afirmativo, escolha o turno desejado:</label>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" name="turnos_aulao[]" value="Matutino" id="turno_matutino">
                          <label class="form-check-label" for="turno_matutino">Turno Matutino</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" name="turnos_aulao[]" value="Vespertino" id="turno_vespertino">
                          <label class="form-check-label" for="turno_vespertino">Turno Vespertino</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" name="turnos_aulao[]" value="Noturno" id="turno_noturno">
                          <label class="form-check-label" for="turno_noturno">Turno Noturno</label>
                        </div>
                      </div>



                    </div>
                    <!-- ****************************************************************************************************************************** -->
                    <hr>
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="termos_condicoes" name="termos_condicoes" required>
                                <label class="form-check-label" for="termos_condicoes" style="font-weight: bold; color: #90aff0; font-size: 0.8rem; text-align: justify;">
                                    Eu li e aceito os 
                                    <a href="{% static 'downloads/edital.pdf' %}" target="_blank" style="text-decoration: underline; font-weight: bold;">
                                        <b>TERMOS e CONDIÇÕES</b>
                                    </a>
                                    deste Edital, incluindo as diretrizes para o exame de Suplência 2025, a data programada para 
                                    <strong>1º de outubro de 2025</strong>, o horário de início às <strong>7h30</strong> e o formato 
                                    <strong>presencial</strong> do exame.
                                </label>
                                
                            </div>
                        </div>
                    </div>
                    <!-- ****************************************************************************************************************************** -->
                <hr>
                    <button type="submit" id="submitButton" class="btn btn-primary w-20" disabled>Cadastrar</button>
                    <button type="button" class="btn btn-secondary" id="fecharBtn" data-bs-dismiss="modal" onclick="location.reload()">Fechar</button>

                </div>
                    </div>
                </form>
            </div>
        </div>




  <!-- Footer -->
    <footer class="footer-bg py-5">
        <div class="container">
            <!-- Linhas principais -->
            <div class="row">
                <!-- Destaques -->
                <div class="col-md-4 mb-4">
                    <h5 class="text-uppercase text-primary mb-4">Destaques</h5>
                    <ul class="list-unstyled">
                        <li class="mb-4 d-flex align-items-start">
                            <img src="{% static 'assets/dist/img/unifespa.png' %}" alt="Unifesspa" class="me-3"
                                style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                            <div>
                                <a href="https://portal.semedcanaadoscarajas.pa.gov.br/unifesspa-abre-edital-para-programa-de-permanencia-de-alunos/"
                                    class="text-white text-decoration-none" target="_blank">
                                    <p style="text-align: justify; color: #ffffff;">
                                        <strong>Unifesspa abre edital para programa de permanência de alunos</strong>
                                    </p>
                                </a>
                                <small class="d-block text-muted;">27 de novembro de 2024</small>
                            </div>
                        </li>
                        <li class="mb-4 d-flex align-items-start">
                            <img src="{% static 'assets/dist/img/eja.png' %}" alt="EJA curso profissionalizante"
                                class="me-3" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                            <div>
                                <a href="https://portal.semedcanaadoscarajas.pa.gov.br/de-olho-no-mercado-de-trabalho-estudantes-da-eja-farao-curso-profissionalizante/"
                                    class="text-white text-decoration-none" target="_blank">
                                    <p style="text-align: justify; color: #ffffff;">
                                        <strong>De olho no mercado de trabalho: Estudantes da EJA farão curso
                                            profissionalizante</strong>
                                    </p>
                                </a>
                                <small class="d-block text-muted;">27 de novembro de 2024</small>
                            </div>
                        </li>
                        <li class="d-flex align-items-start">
                            <img src="{% static 'assets/dist/img/planetario.png' %}" alt="Planetário Canaã dos Carajás"
                                class="me-3" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                            <div>
                                <a href="https://portal.semedcanaadoscarajas.pa.gov.br/planetario-completa-1-ano-com-destaque-para-educacao-e-turismo-em-canaa-dos-carajas/"
                                    class="text-white text-decoration-none" target="_blank">
                                    <p style="text-align: justify; color: #ffffff;">
                                        <strong>Planetário completa 1 ano com destaque para educação e turismo em Canaã
                                            dos Carajás</strong>
                                    </p>
                                </a>
                                <small class="d-block text-muted;">27 de novembro de 2024</small>
                            </div>
                        </li>
                    </ul>
                </div>
                <!-- Mais Acessados -->
                <div class="col-md-4 mb-4">
                    <h5 class="text-uppercase text-info mb-4">Mais Acessados</h5>
                    <ul class="list-unstyled">
                        <li class="mb-4 d-flex align-items-start">
                            <img src="{% static 'assets/dist/img/diretor.png' %}" alt="Certificação para Diretores"
                                class="me-3" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                            <div>
                                <a href="https://portal.semedcanaadoscarajas.pa.gov.br/processo-de-selecao-e-certificacao-para-a-funcao-publica-de-diretor-e-vice-diretor-de-unidade-escolar/"
                                    class="text-white text-decoration-none" target="_blank">
                                    <p style="text-align: justify;">
                                        <strong>Processo de seleção e certificação para a função pública de Diretor e
                                            Vice-diretor de unidade escolar</strong>
                                    </p>
                                </a>
                                <small class="d-block text-muted">18 de outubro de 2023</small>
                            </div>
                        </li>
                        <li class="mb-4 d-flex align-items-start">
                            <img src="{% static 'assets/dist/img/eja_matriculas.png' %}" alt="Matrículas para EJA"
                                class="me-3" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                            <div>
                                <a href="https://portal.semedcanaadoscarajas.pa.gov.br/matriculas-abertas-para-educacao-de-jovens-e-adultos-eja-em-canaa-dos-carajas/"
                                    class="text-white text-decoration-none" target="_blank">
                                    <p style="text-align: justify;">
                                        <strong>Matrículas abertas para Educação de Jovens e Adultos - EJA em Canaã dos
                                            Carajás</strong>
                                    </p>
                                </a>
                                <small class="d-block text-muted">3 de fevereiro de 2022</small>
                            </div>
                        </li>
                        <li class="d-flex align-items-start">
                            <img src="{% static 'assets/dist/img/exame_suplencia.png' %}" alt="Exame de Suplência"
                                class="me-3" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                            <div>
                                <a href="https://portal.semedcanaadoscarajas.pa.gov.br/abertas-as-inscricoes-para-exame-de-suplencia-do-ensino-fundamental/"
                                    class="text-white text-decoration-none" target="_blank">
                                    <p style="text-align: justify;">
                                        <strong>Abertas as inscrições para Exame de Suplência do Ensino
                                            Fundamental</strong>
                                    </p>
                                </a>
                                <small class="d-block text-muted">1 de março de 2023</small>
                            </div>
                        </li>
                    </ul>
                </div>
                <!-- Temas Mais Acessados -->
                <div class="col-md-4 mb-4">
                    <h5 class="text-uppercase text-success mb-4">Temas Mais Acessados</h5>
                    <div class="d-flex flex-wrap align-items-baseline">
                        <span class="badge bg-primary m-1">Educação <span
                                class="badge bg-light text-dark ms-1">243</span></span>
                        <span class="badge bg-primary m-1">Destaque <span
                                class="badge bg-light text-dark ms-1">234</span></span>
                        <span class="badge bg-primary m-1">Ensino Superior <span
                                class="badge bg-light text-dark ms-1">58</span></span>
                        <span class="badge bg-primary m-1">Polo Educacional <span
                                class="badge bg-light text-dark ms-1">42</span></span>
                        <span class="badge bg-primary m-1">Ensino Infantil <span
                                class="badge bg-light text-dark ms-1">42</span></span>
                        <span class="badge bg-primary m-1">Jovens e Adultos <span
                                class="badge bg-light text-dark ms-1">37</span></span>
                        <span class="badge bg-primary m-1">Cultura <span
                                class="badge bg-light text-dark ms-1">36</span></span>
                        <span class="badge bg-primary m-1">Ensino Integral <span
                                class="badge bg-light text-dark ms-1">27</span></span>
                        <span class="badge bg-primary m-1">Governo <span
                                class="badge bg-light text-dark ms-1">26</span></span>
                        <span class="badge bg-primary m-1">Esportes <span
                                class="badge bg-light text-dark ms-1">19</span></span>
                        <span class="badge bg-primary m-1">Saúde Escolar <span
                                class="badge bg-light text-dark ms-1">15</span></span>
                        <span class="badge bg-primary m-1">Inclusão Digital <span
                                class="badge bg-light text-dark ms-1">12</span></span>
                    </div>
                </div>
            </div>
            <!-- Linha inferior -->
            <hr class="border-secondary">
            <div class="row align-items-center">
                <!-- Logo -->
                <div class="col-md-4 mb-4 mb-md-0 d-flex justify-content-center align-items-center">
                    <img src="{% static 'assets/dist/img/logoSite2.png' %}" alt="Logo SEMED"
                        style="width: 150px; height: 150px; object-fit: contain;">
                </div>

                <!-- Informações de Contato -->
                <div class="col-md-4 mb-4 mb-md-0 text-center">
                    <p style="text-align: justify;">
                        <strong>Horário de funcionamento:</strong> de 08:00 às 12:00 (atendimento ao público) e das
                        14:00 às 18:00 (expediente interno).
                    </p>
                    <p style="text-align: justify;">
                        <strong>Contato:</strong> <a href="mailto:assec@semedcanaadoscarajas.pa.gov.br"
                            class="text-warning text-decoration-none">assec@semedcanaadoscarajas.pa.gov.br</a>
                    </p>
                </div>
                <!-- Redes Sociais -->
                <div class="col-md-4 text-center text-md-end">
                    <h5 class="text-uppercase text-info mb-3">Acompanhe Nossas Redes</h5>
                    <a href="https://www.facebook.com/semedcanaadoscarajas/" class="text-white me-3" target="_blank"
                        style="text-decoration: none;">
                        <i class="fab fa-facebook fa-2x"></i>
                    </a>
                    <a href="https://www.instagram.com/semedcanaadoscarajas/" class="text-white me-3" target="_blank"
                        style="text-decoration: none;">
                        <i class="fab fa-instagram fa-2x"></i>
                    </a>
                    <a href="https://www.youtube.com/channel/UC-_-paASaztXO8yJRLxT32A/" class="text-white me-3"
                        target="_blank">
                        <i class="fab fa-youtube fa-2x"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

<!-- jQuery (obrigatório antes do Select2 e Bootstrap) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Select2 (CSS + JS) -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<!-- Bootstrap Bundle (com Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Chart.js + Plugin de rótulos -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>




<!-- SCRIPT DE CONTROLE -->
<script>
document.addEventListener('DOMContentLoaded', function () {
    const opcaoSim = document.getElementById('prova_todas_disciplinas_sim');
    const opcaoNao = document.getElementById('prova_todas_disciplinas_nao');
    const container = document.getElementById('container-disciplinas');

    function toggleDisciplinas() {
        if (container && opcaoNao && opcaoNao.checked) {
            container.style.display = 'block';
        } else {
            container.style.display = 'none';
        }
    }

    // Reforço: nunca deixar o "Sim" marcado
    if (opcaoSim) {
        opcaoSim.checked = false;
        opcaoSim.disabled = true;
    }

    if (opcaoNao) {
        opcaoNao.checked = true;
        opcaoNao.addEventListener('change', toggleDisciplinas);
    }

    toggleDisciplinas();
});
</script>



<script>
  function normalizar(str) {
    return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();
}
</script>

<script>
  function abrirModalReinscricao() {
    // Espera a DOM estar carregada e o modal disponível
    setTimeout(() => {
        preencherFormularioReinscricao();  // preenche o formulário
    }, 300);  // Dá tempo do modal aparecer e os scripts estarem disponíveis
}

</script>

<script>
  const aprovadas = parseInt("{{ disciplinas_aprovadas|length|default:'0' }}") || 0;
  const pendentes = parseInt("{{ disciplinas_pendentes|length|default:'0' }}") || 0;
  const total = aprovadas + pendentes;

  const ctx = document.getElementById('chartProgresso').getContext('2d');

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Aprovadas', 'Pendentes'],
      datasets: [{
        label: 'Disciplinas',
        data: [aprovadas, pendentes],
        backgroundColor: ['#4caf50', '#ffc107'],
        borderRadius: 12,
        barThickness: 50,
        hoverBackgroundColor: ['#388e3c', '#e0a800']
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: '#343a40',
          titleColor: '#fff',
          bodyColor: '#fff',
          callbacks: {
            label: function (context) {
              const valor = context.raw;
              const percentual = total > 0 ? ((valor / total) * 100).toFixed(1) : 0;
              return `${context.label}: ${valor} (${percentual}%)`;
            }
          }
        },
        datalabels: {
          color: '#333',
          font: { weight: 'bold', size: 12 },
          anchor: 'end',
          align: 'top',
          formatter: function (valor) {
            const percentual = total > 0 ? ((valor / total) * 100).toFixed(1) : 0;
            return `${valor} (${percentual}%)`;
          }
        },
        title: {
          display: true,
          text: 'Progresso nas Disciplinas',
          font: { size: 18, weight: 'bold' },
          color: '#212529'
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          grace: '5%',
          ticks: {
            color: '#495057',
            font: { weight: 'bold' }
          },
          grid: {
            color: '#dee2e6'
          }
        },
        x: {
          ticks: {
            color: '#495057',
            font: { weight: 'bold' }
          },
          grid: {
            display: false
          }
        }
      }
    },
    plugins: [ChartDataLabels]
  });
</script>

<script>
  function carregarDisciplinasPendentes(callback) {
    const container = document.getElementById("container-disciplinas");
    const pendentesJsonElement = document.getElementById('disciplinasPendentes');

    if (!pendentesJsonElement) {
        setTimeout(() => carregarDisciplinasPendentes(callback), 100);
        return;
    }

    const pendentes = JSON.parse(pendentesJsonElement.textContent || '[]');

    fetch("/disciplinas-json/")
        .then(response => response.json())
        .then(data => {
            container.innerHTML = "";

            if (!Array.isArray(data) || data.length === 0) {
                container.innerHTML = '<p class="text-danger">Nenhuma disciplina cadastrada.</p>';
                return;
            }

            data.forEach((disc, index) => {
                if (pendentes.length === 0 || pendentes.some(p => normalizar(p) === normalizar(disc.nome))) {
                    const colDiv = document.createElement("div");
                    colDiv.className = "col-md-6 mb-2";
                    colDiv.innerHTML = `
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox"
                                id="disciplina_${index}"
                                name="disciplinas[]"
                                value="${disc.nome}">
                            <label class="form-check-label" for="disciplina_${index}">
                                ${disc.nome}
                            </label>
                        </div>
                    `;
                    container.appendChild(colDiv);
                }
            });

            if (callback) callback();  // Marcar checkboxes após renderizar
        })
        .catch(error => {
            console.error("Erro ao carregar disciplinas:", error);
            container.innerHTML = '<p class="text-danger">Erro ao carregar disciplinas.</p>';
        });
}



</script>

<!-- <script>
  function toggleDisciplinas() {
    const grupo = document.getElementById('grupo_disciplinas');
    const opcaoNao = document.getElementById('prova_todas_disciplinas_nao');
    grupo.style.display = opcaoNao.checked ? 'block' : 'none';
  }
  document.addEventListener('DOMContentLoaded', toggleDisciplinas);
</script> -->

    <!-- Verificação CPF via AJAX -->
<script>
   $(document).ready(function () {
    $('#verificarCpfBtn').click(function () {
        var cpf = $('#cpf_candidato_modal').val();  // AJUSTADO

        console.log("CPF inserido: " + cpf);

        // Faz a requisição AJAX para verificar o CPF
        $.ajax({
            url: "{% url 'verificar_cpf_ajax' %}",
            type: "POST",
            data: {
                'cpf': cpf,
                'csrfmiddlewaretoken': '{{ csrf_token }}'
            },
            success: function (response) {
                console.log("Resposta recebida:", response);

                // Limpa o campo CPF após o envio da solicitação
                $('#cpf').val('');  // Clear the CPF field

                if (response.status === 'existe') {
                    // Mostra alerta dentro do modal informando que o CPF já existe
                    alert("Este CPF já está cadastrado no sistema.");
                } else if (response.status === false || response.existe === false || response.status === "nao_existe") {
                    $('#cpf_cadastro_form').val(cpf).prop('readonly', true);
                    $('#cadastroModal').modal('show');
                    $('#verificarCpfModal').modal('hide');
                } else {
                    alert("Erro inesperado ao verificar o CPF.");
                }
            },
            error: function (xhr, status, error) {
                console.error("Erro na requisição AJAX:", error);
                // Limpa o campo CPF após o erro
                $('#cpf').val('');  // Clear the CPF field
                alert("Erro na verificação do CPF.");
            }
        });
    });
});
</script>

<script>
    function searchSchools() {
        const address = document.getElementById('address-input').value;
        const neighborhood = document.getElementById('neighborhood-input').value;
        const cep = document.getElementById('cep-input').value;
    
        const queryString = new URLSearchParams({ address, neighborhood, cep }).toString();
    
        fetch(`/search-schools/?${queryString}`)
            .then(response => response.json())
            .then(data => {
                const resultsDiv = document.getElementById('school-results');
                resultsDiv.innerHTML = '';
    
                if (data.schools.length > 0) {
                    data.schools.forEach(school => {
                        const schoolItem = document.createElement('div');
                        schoolItem.classList.add('school-item');
                        schoolItem.innerHTML = `<p><strong>${school.name}</strong> - ${school.neighborhood} - ${school.address} - CEP: ${school.cep}</p>`;
                        resultsDiv.appendChild(schoolItem);
                    });
                } else {
                    resultsDiv.innerHTML = '<p>Nenhuma escola encontrada para os critérios informados.</p>';
                }
            })
            .catch(error => console.error('Erro:', error));
    }
    </script>

    <!-- Script to handle the timer -->
<script>
    // Function to start the 20-minute countdown
    function startTimer(duration, display) {
        let timer = duration, minutes, seconds;
        const interval = setInterval(function () {
            minutes = parseInt(timer / 60, 10);
            seconds = parseInt(timer % 60, 10);

            minutes = minutes < 10 ? "0" + minutes : minutes;
            seconds = seconds < 10 ? "0" + seconds : seconds;

            display.textContent = minutes + ":" + seconds;

            if (--timer < 0) {
                clearInterval(interval); // Clear the interval when the time runs out
                $('#cadastroModal').modal('hide'); // Close the modal
                alert('O tempo para o preenchimento do cadastro expirou.'); // Optional: alert the user
            }
        }, 1000);
    }

    // When the modal is shown, start the timer
    $('#cadastroModal').on('shown.bs.modal', function () {
        const twentyMinutes = 60 * 20, // 20 minutes in seconds
            display = document.querySelector('#timer');
        startTimer(twentyMinutes, display);
    });

</script>

<!-- Script to insert current date -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Function to format the date
        function formatDate(date) {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('pt-BR', options);
        }

        // Get the current date and format it
        const currentDate = new Date();
        document.getElementById("currentDate").textContent = formatDate(currentDate);
    });
</script>

<script>
    function searchBairro() {
    const bairroInput = document.getElementById('bairro').value;

    if (bairroInput.length > 2) { // Start searching when more than 2 characters are typed
        fetch(`/search-bairro/?query=${bairroInput}`)
            .then(response => response.json())
            .then(data => {
                const resultsDiv = document.getElementById('bairro-results');
                resultsDiv.innerHTML = ''; // Clear previous results

                if (data.results.length > 0) {
                    data.results.forEach(bairro => {
                        const item = document.createElement('div');
                        item.textContent = `${bairro.logradouro_nome} - ${bairro.bairro_distrito} (CEP: ${bairro.cep})`;
                        resultsDiv.appendChild(item);
                    });
                } else {
                    resultsDiv.innerHTML = '<p>Nenhum bairro encontrado.</p>';
                }
            })
            .catch(error => console.error('Erro:', error));
    }
}
</script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
    fetch('/get-bairros/')  // URL pointing to your Django view
        .then(response => response.json())
        .then(data => {
            const bairroSelect = document.getElementById('bairro');
            data.bairros.forEach(bairro => {
                const option = document.createElement('option');
                option.value = bairro.id;
                option.text = `${bairro.bairro_distrito}`;
                bairroSelect.appendChild(option);
            });
        })
        .catch(error => console.error('Erro ao buscar os bairros:', error));
});
</script>

<script>
    function toggleSpecialNeeds(isEnabled) {
    const selectField = document.getElementById('necessidade_especial_detalhe');
    
    if (isEnabled) {
        selectField.removeAttribute('disabled');
    } else {
        selectField.setAttribute('disabled', true);
        selectField.value = ''; // Clear the select field when disabled
    }
}

// By default, the "Não" option will disable the select field when the page loads
window.onload = function() {
    toggleSpecialNeeds(false);
};
</script>

<script>
    $(document).ready(function() {
        $('#disciplinas').select2({
            placeholder: "Selecione as disciplinas",
            allowClear: true,
            closeOnSelect: false // Keep the dropdown open after selecting an item
        }).on('change', function() {
            // Hide all selected options except the first one
            var selectedOptions = $(this).find('option:selected');
            
            // Hide all selected choices, except the first
            selectedOptions.each(function(index) {
                if (index > 0) {
                    $(this).attr('data-hidden', true); // Mark as hidden
                } else {
                    $(this).removeAttr('data-hidden'); // Keep the first visible
                }
            });

            // Refresh the display of the select field
            $(this).trigger('change.select2');
        });

        // Custom format to hide elements marked as hidden
        function formatState(state) {
            if (!state.id) {
                return state.text; // optgroup
            }
            // If the option is marked as hidden, do not display it
            if ($(state.element).attr('data-hidden')) {
                return null;
            }
            return state.text;
        }

        $('#disciplinas').select2({
            templateResult: formatState
        });
    });
</script>



<script>
    document.addEventListener("DOMContentLoaded", function () {
    const termosCheckbox = document.getElementById('termos_condicoes');
    const submitButton = document.getElementById('submitButton');
    const cadastroForm = document.getElementById('cadastroForm');

    if (termosCheckbox && submitButton) {
        termosCheckbox.addEventListener('change', function () {
            submitButton.disabled = !this.checked;
        });
    }

    if (cadastroForm && termosCheckbox) {
        cadastroForm.addEventListener('submit', function (event) {
            if (!termosCheckbox.checked) {
                event.preventDefault();
                termosCheckbox.focus();
            }
        });
    }
});

</script>
<!-- JavaScript Senha-->
<script>
    function togglePassword(inputId, eyeIconId) {
        var input = document.getElementById(inputId);
        var eyeIcon = document.getElementById(eyeIconId);
    
        if (input.type === "password") {
            input.type = "text";
            eyeIcon.classList.remove("fa-eye");
            eyeIcon.classList.add("fa-eye-slash");
        } else {
            input.type = "password";
            eyeIcon.classList.remove("fa-eye-slash");
            eyeIcon.classList.add("fa-eye");
        }
    }
    </script>

<!-- JavaScript -->
<script>
function verificarIdade() {
    const inputNascimento = document.getElementById('data_nascimento');
    const dataNascimento = new Date(inputNascimento.value);
    const dataLimite = new Date('2025-10-19'); // Data de verificação: 19/10/2025

    const radioSim = document.getElementById('maior_de_18_sim');
    const radioNao = document.getElementById('maior_de_18_nao');

    // Verifica se a data de nascimento é válida
    if (isNaN(dataNascimento.getTime())) {
        alert("Por favor, insira uma data de nascimento válida.");
        radioSim.disabled = true;
        radioNao.disabled = true;
        return;
    }

    // Cálculo da idade em 19/10/2025
    let idade = dataLimite.getFullYear() - dataNascimento.getFullYear();
    const mes = dataLimite.getMonth() - dataNascimento.getMonth();
    const dia = dataLimite.getDate() - dataNascimento.getDate();

    if (mes < 0 || (mes === 0 && dia < 0)) {
        idade--;
    }

    const form = document.getElementById('reinscricaoForm');  // Corrigido


    if (idade >= 15 && idade < 18) {
        // 15 a 17 anos
        radioSim.disabled = true;
        radioNao.disabled = false;
        radioNao.checked = true;

        document.getElementById('nome_responsavel').disabled = false;
        document.getElementById('cpf_responsavel').disabled = false;
        document.getElementById('rg_responsavel').disabled = false;
        document.getElementById('tipo_responsavel').disabled = false;

        // Reativa os campos do formulário (exceto fechar)
        for (let i = 0; i < form.elements.length; i++) {
            if (form.elements[i].id !== 'fecharBtn') {
                form.elements[i].disabled = false;
            }
        }

    } else if (idade >= 18) {
        // 18 anos ou mais
        radioSim.disabled = false;
        radioNao.disabled = false;
        radioSim.checked = true;

        document.getElementById('nome_responsavel').disabled = true;
        document.getElementById('cpf_responsavel').disabled = true;
        document.getElementById('rg_responsavel').disabled = true;
        document.getElementById('tipo_responsavel').disabled = true;

        for (let i = 0; i < form.elements.length; i++) {
            form.elements[i].disabled = false;
        }

    } else {
        // Menor de 15 anos
        radioSim.disabled = true;
        radioNao.disabled = true;
        radioSim.checked = false;
        radioNao.checked = false;

        for (let i = 0; i < form.elements.length; i++) {
            form.elements[i].disabled = true;
        }
        document.getElementById('fecharBtn').disabled = false;
        alert("A idade mínima para participar é 15 anos até 19/10/2025.");
    }
}
</script>



{% if messages %}
    <div class="container">
        {% for message in messages %}
            <div class="alert {% if message.tags %}alert-{{ message.tags }}{% else %}alert-info{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    </div>
{% endif %}


</script>



<script>
function preencherFormularioReinscricao() {
    const candidato = {
        nome: "{{ candidato.nome|escapejs }}",
        email: "{{ candidato.email|default_if_none:''|escapejs }}",
        cpf: "{{ candidato.cpf|escapejs }}",
        data_nascimento: "{{ candidato.data_nascimento|date:'Y-m-d' }}",
        telefone: "{{ candidato.telefone|default_if_none:''|escapejs }}",
        telefone2: "{{ candidato.telefone_2|default_if_none:''|escapejs }}",
        cidade: "{{ candidato.cidade|default_if_none:''|escapejs }}",
        endereco: "{{ candidato.endereco|default_if_none:''|escapejs }}",
        bairro: "{{ candidato.bairro|default_if_none:''|escapejs }}",
        escola: "{{ candidato.escola_2024|default_if_none:''|escapejs }}",
        local_prova: "{{ candidato.local_prova|default_if_none:''|escapejs }}",
        fez_exame: "{{ candidato.fez_exame_supletivo|default_if_none:'Não' }}",
        necessidade_especial: "{{ candidato.possui_necessidade_especial|default_if_none:'Não' }}",
        necessidade_especial_detalhe: "{{ candidato.necessidade_especial_detalhe|default_if_none:''|escapejs }}"
        // 🔒 Ignora candidato.prova_todas_disciplinas para forçar "Não"
    };

    // Preenche os campos normais
    document.getElementById("nome_completo").value = candidato.nome;
    document.getElementById("email").value = candidato.email;
    document.getElementById("cpf_form").value = candidato.cpf;
    document.getElementById("data_nascimento").value = candidato.data_nascimento;
    document.getElementById("telefone").value = candidato.telefone;
    document.getElementById("telefone_2").value = candidato.telefone2;
    document.getElementById("cidade").value = candidato.cidade;
    document.getElementById("endereco").value = candidato.endereco;
    document.getElementById("bairro").value = candidato.bairro;
    document.getElementById("escola_2024").value = candidato.escola;
    document.getElementById("local_prova").value = candidato.local_prova;

    // Radios de exame e necessidade especial
    const fezExameId = "fez_exame_" + normalizar(candidato.fez_exame);
    const necessidadeId = "necessidade_especial_" + normalizar(candidato.necessidade_especial);
    const fezExameEl = document.getElementById(fezExameId);
    const necessidadeEl = document.getElementById(necessidadeId);
    if (fezExameEl) fezExameEl.checked = true;
    if (necessidadeEl) necessidadeEl.checked = true;

    toggleSpecialNeeds(candidato.necessidade_especial === "Sim");
    document.getElementById("necessidade_especial_detalhe").value = candidato.necessidade_especial_detalhe;

    // Força "Não" como padrão e limpa os checkboxes
    const opcaoSim = document.getElementById("prova_todas_disciplinas_sim");
    const opcaoNao = document.getElementById("prova_todas_disciplinas_nao");
    opcaoNao.checked = true;
    toggleDisciplinas();

    // Aguarda disciplinas carregarem e desmarca todas antes de marcar pendentes
    carregarDisciplinasPendentes(() => {
        const checkboxes = document.querySelectorAll('input[name="disciplinas[]"]');
        checkboxes.forEach(cb => cb.checked = false); // desmarcar todas
        const pendentes = JSON.parse(document.getElementById('disciplinasPendentes')?.textContent || '[]');
        checkboxes.forEach(cb => {
            cb.checked = pendentes.includes(cb.value);
        });
    });

    // Verifica idade após preenchimento de nascimento
    setTimeout(() => verificarIdade(), 200);
}
</script>




<script>
function aplicarMascaraCPF(input) {
  input.addEventListener("input", function () {
    let valor = input.value.replace(/\D/g, ""); // Remove tudo que não for número
    if (valor.length > 11) valor = valor.slice(0, 11);
    valor = valor.replace(/(\d{3})(\d)/, "$1.$2");
    valor = valor.replace(/(\d{3})(\d)/, "$1.$2");
    valor = valor.replace(/(\d{3})(\d{1,2})$/, "$1-$2");
    input.value = valor;
  });
}

document.addEventListener("DOMContentLoaded", function () {
  aplicarMascaraCPF(document.getElementById("cpf_form"));
  aplicarMascaraCPF(document.getElementById("cpf_responsavel"));
});
</script>



           <!-- Script para exibir/ocultar os turnos -->
            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    const sim = document.getElementById('aulao_sim');
                    const nao = document.getElementById('aulao_nao');
                    const camposTurno = document.getElementById('aulao_campos');

                    function toggleTurnos() {
                        camposTurno.style.display = sim.checked ? 'block' : 'none';
                    }

                    sim.addEventListener('change', toggleTurnos);
                    nao.addEventListener('change', toggleTurnos);

                    // Executa ao carregar a página
                    toggleTurnos();
                });
            </script>



            <script>
document.addEventListener('DOMContentLoaded', function () {
    const sim = document.getElementById('fez_exame_sim');
    const nao = document.getElementById('fez_exame_nao');
    const divAno = document.getElementById('ano_ultima_prova_div');
    const inputAno = document.getElementById('ano_ultima_prova');

    function toggleAnoProva() {
        if (sim.checked) {
            divAno.style.display = 'block';
            inputAno.disabled = false;
        } else {
            divAno.style.display = 'none';
            inputAno.disabled = true;
            inputAno.value = ''; // limpa se ocultar
        }
    }

    sim.addEventListener('change', toggleAnoProva);
    nao.addEventListener('change', toggleAnoProva);

    // Dispara na carga para manter o estado
    toggleAnoProva();
});
</script>


<script>
function toggleAulaoCampos() {
  const sim = document.getElementById('aulao_sim');
  const campos = document.getElementById('aulao_campos');
  if (sim.checked) {
    campos.style.display = 'block';
  } else {
    campos.style.display = 'none';
    // Desmarcar os checkboxes quando "Não" for escolhido
    document.querySelectorAll('input[name="turnos_aulao[]"]').forEach(cb => cb.checked = false);
  }
}

// Executa ao carregar a página
document.addEventListener('DOMContentLoaded', toggleAulaoCampos);
</script>


<script>
document.addEventListener('DOMContentLoaded', function () {
    const opcaoSim = document.getElementById('prova_todas_disciplinas_sim');
    const opcaoNao = document.getElementById('prova_todas_disciplinas_nao');
    const container = document.getElementById('container-disciplinas');

    function toggleDisciplinas() {
        if (container && opcaoNao) {
            container.style.display = opcaoNao.checked ? 'block' : 'none';
        }
    }

    // Reforço: desmarca "Sim" se vier marcado
    if (opcaoSim && opcaoSim.checked) {
        opcaoSim.checked = false;
    }

    // Reforço: marca "Não"
    if (opcaoNao) {
        opcaoNao.checked = true;
        opcaoNao.addEventListener('change', toggleDisciplinas);
    }

    toggleDisciplinas();
});
</script>


<script>
document.addEventListener('DOMContentLoaded', function () {
    const form = document.getElementById('reinscricaoForm');
    const radioSim = document.getElementById('prova_todas_disciplinas_sim');

    if (form && radioSim) {
        form.addEventListener('submit', function (e) {
            if (radioSim.checked) {
                e.preventDefault();
                Swal.fire({
                    icon: 'error',
                    title: 'Opção inválida',
                    text: 'A opção "Sim" está desabilitada no momento. Por favor, selecione "Não" e escolha as disciplinas pendentes.',
                    confirmButtonText: 'Entendi'
                });
            }
        });
    }
});
</script>




</body>
</html>
